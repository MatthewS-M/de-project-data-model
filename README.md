# Проект по актуализации модели данных
>Передо мной была поставлена задача создать витрину данных для RFM-классификации пользователей приложения. Краткое описание ТЗ:

**1. Требования к витрине**
Витрина должна быть создана в базе данных компании, в схеме analysis. Структура витрины должна включать поля: user_id, recency, frequency, monetary_value. Данные для анализа должны быть за период с начала 2022 года.
**2. Реализация RFM-классификации**
Изучите структуру таблиц в схеме production. Опишите качество данных в документе data_quality.md. Укажите, какие инструменты для обеспечения качества данных использованы в таблицах.
Создайте представления для таблиц из схемы production в схеме analysis (например, Users, OrderItems, OrderStatuses, Products, Orders).
Напишите DDL-запрос для создания витрины. Заполните витрину данными: напишите SQL-запрос для расчета витрины на языке SQL и заполните таблицу, созданную в предыдущем пункте. Рассчитайте витрину поэтапно, сначала заведите таблицы под каждый показатель. Создайте документы datamart_ddl.sql, tmp_rfm_recency.sql, tmp_rfm_frequency.sql, tmp_rfm_monetary_value.sql и datamart_query.sql.
Выясните, что бэкенд-разработчики приложения обновили структуру данных в схеме production: в таблице Orders больше нет поля status. Внесите изменения в то, как формируется представление analysis.Orders: верните в него поле status. Значение в этом поле должно соответствовать последнему по времени статусу из таблицы production.OrderStatusLog. Создайте документ orders_view.sql и сохраните в нём написанный запрос.
